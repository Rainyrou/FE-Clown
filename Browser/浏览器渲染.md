[https://segmentfault.com/a/1190000012925872](https://segmentfault.com/a/1190000012925872)

浏览器的渲染进程为多线程的

- GUI 渲染线程解析 HTML 和 CSS，并行生成 DOM 树和 CSS Object Model 树，因此 CSS 加载不阻塞 DOM 的解析，基于这两者生成 RenderObject 树，其描述需渲染的页面元素及其样式，因此 CSS 加载阻塞 DOM 的渲染，GUI 渲染线程与 JS 引擎线程互斥（因此 CSS 加载阻塞 JS 执行）以防止两者同时修改 DOM 或其他共享资源，当执行 JS 引擎线程时 GUI 渲染线程挂起，被添加到队列中等待 JS 引擎空闲时执行，JS 引擎线程解析和执行 Javascript，势必阻塞页面渲染
- GUI 渲染线程布局计算 RenderObject 树中元素的位置和尺寸，绘制 RenderObject 树
- 浏览器主进程将默认图层和复合图层传递给 GPU 进程，GPU 进程合成各图层，生成最终图像
- 事件触发线程用于事件循环，当 JS 引擎执行 Javascript 代码块如 `setTimeout` 时将相应任务添加到事件触发线程中，等待 JS 引擎线程空闲时执行
* 定时触发器线程即 `setTimeout` 和 `setInterval` 所在线程，浏览器定时计数器不由 JS 引擎线程计时，而通过定时触发器线程计时，因为 JS 引擎线程为单线程，若处于阻塞状态则影响计时的准确性。定时触发器线程计时完毕将相应任务添加到事件触发线程中，等待 JS 引擎线程空闲时执行
* 异步 HTTP 请求线程用于处理浏览器后台网络请求如通过 AJAX/Axios/Fetch 发送的异步 HTTP 请求，异步 HTTP 请求线程请求完毕将相应任务添加到事件触发线程中，等待 JS 引擎线程空闲时执行

浏览器为多进程的，操作系统为其进程分配 CPU 和内存等使其运行，每打开一个 Tab 页即创建一个独立的浏览器进程（在 Chrome 的 More tools 中打开任务管理器即可看到进程列表，由于 Chrome 的优化机制 Tab 页和进程一一对应的情况并不绝对如合并多个空白 Tab 页），多进程可避免单页面或第三方插件崩溃影响整个浏览器，同时充分利用多核 CPU

1. 浏览器主进程：用于显示用户界面，将渲染进程获取的内存之 Bitmap 绘制到用户界面上，与用户交互，管理各个页面和网络资源
2. 渲染进程（内核）：每打开一个 Tab 页即创建一个独立的浏览器渲染进程，用于渲染页面、处理事件和执行脚本
3. GPU 进程：用于 3D 绘制等
4. 第三方插件进程：插件和进程一一对应，仅在使用插件时才创建对应的第三方插件进程

![[Pasted image 20240502103023.png]]

浏览器主进程与渲染进程间通信：主进程接收到请求后首先获取页面内容，将该任务通过 RendererHost 接口传递给渲染进程，渲染进程接收并处理任务后，再传递给 GUI 渲染线程，渲染页面，再将渲染结果返回给渲染进程，渲染进程将其返回给主进程，主进程接收到渲染结果并将其绘制

![[Pasted image 20240502100855.png]]


