##### CDN

CDN（Content Delivery Network）是基于 DNS 协议实现的一种分布式网络，它使用"边缘计算"原理，通过在各地部署多个节点服务器，将网站内容分发到最接近用户的节点，从而更快更可靠地将内容送达给用户

###### CDN 的核心工作原理

- CDN 提供商在全球范围内的多个地点部署节点服务器，这些节点服务器会缓存源服务器上的内容
- 当用户请求一个通过 CDN 服务加速的网站或资源时，该请求首先会到达 DNS 服务器。DNS 解析系统会解析并返回最接近用户且负载较低的 CDN 节点的 IP 地址（负载均衡）
- 用户的请求被重定向到所选的 CDN 节点。用户从这个节点获取内容，这个节点就像该用户的本地服务器。如果所请求的内容已经缓存在这个节点，它将直接从此节点传输到用户。如果内容在该节点上未被缓存，该节点将从源服务器或其他节点获取内容，缓存一份，并将其传输到用户
- CDN 节点定期检查内容的有效性，并依据预设的策略（如时间戳或 ETag）更新过期或更改的内容，确保其节点上的内容是最新的

##### DNS

DNS (Domain Name System) 作为域名和 IP 地址之间的映射系统，允许人们使用易于记忆的域名（如 `example.com`）来访问特定的服务器，而服务器实际上是通过 IP 地址（如 `192.168.1.1`）来定位的。以下是 DNS 的一般查询流程以及解析域名的实现机制

###### DNS 查询流程：

1. 当用户在浏览器中输入一个 URL 并按 Enter 键后，浏览器会首先查找自己的 DNS 缓存（这个缓存只有浏览器自己可以访问）看是否已经存储了这个域名对应的 IP 地址
2. 如果没有找到，操作系统会检查本地的 `hosts` 文件。`hosts` 文件是一个系统文件，允许手动映射域名到特定的 IP 地址
3. 如果没有找到，操作系统会查找自己的 DNS 缓存是否有这个域名对应的 IP 地址
4. 如果上述步骤都没有找到域名对应的 IP 地址，操作系统会将 DNS 查询请求发送到本地网络配置中指定的 DNS 服务器。这个服务器通常是由 ISP（Internet Service Provider）提供的
5. 如果本地 DNS 服务器没有缓存该域名对应的 IP 地址，它开始一个迭代查询过程：询问根 DNS 服务器->根据根 DNS 服务器的指引，询问相应的顶级域（TLD）服务器（如 `.com`、`.org` 等）->根据 TLD 服务器的指引，询问权威 DNS 服务器(二级域名和更多级的域名都在权威域名服务器解析)
6. 权威 DNS 服务器回应本地 DNS 服务器查询请求，提供域名对应的 IP 地址，或者返回一个错误（如域名不存在）
7. 本地 DNS 服务器将查询结果（无论是 IP 地址还是错误）缓存一定时间（根据 DNS 记录的 TTL，即 Time to Live 值决定），以便下次有相同的查询请求时，可以直接从缓存中提供答案
8. 本地 DNS 服务器将查询结果返回给发起查询的客户端程序
9. 客户端程序（如操作系统或 Web 浏览器）可能也会缓存这个结果，以便将来需要时能更快地解析相同的域名

- 分层为了通过负载均衡来分散压力，三级分层（根域名服务器、顶级域名服务器、权威域名服务器）在实践中被证明是既能满足全球互联网需求，又能保持稳定和有效的一个层次
- 在编程层面，实现一个 DNS 客户端或服务器需要深入了解网络编程和 DNS 协议的细节。大部分现代操作系统和编程语言都提供了抽象级别更高的库或接口，使得开发人员无需直接处理 DNS 协议的复杂性