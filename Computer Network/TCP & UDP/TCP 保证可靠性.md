1. 三次握手

- 第一次握手：客户端发送一个 SYN 同步序列报文，以开始连接
- 第二次握手：服务端返回一个 SYN-ACK 同步应答报文，以确认接收到 SYN
- 第三次握手：客户端发送一个 ACK 确认报文，作为对 SYN-ACK 的确认

2. 确认应答 & 超时重传：给每个 TCP 包分配一个序列号，接收方可通过序列号检测丢包和重排包序，当发送方发送一个数据段后，它启动一个定时器，接收方接收到包后返回确认应答，确认已接收的包，发送方若在预定时间内没有收到 ACK，超时重传该数据包

3. 流量控制：使用滑动窗口机制来进行流量控制，以防止快速发送方淹没慢速接收方，滑动窗口即限制发送方在等待接收方确认前可发送的数据量，发送方的窗口大小基于接收方的接收窗口和网络的拥塞窗口之最小值，根据网络条件动态调整，接收方在 ACK 中指定一个窗口大小，告诉发送方它还能接收多少字节的数据，发送方根据该窗口大小来限制未被确认的数据量，从而避免接收方的缓冲区溢出

- 滑动窗口大：当网络状态良好且接收方缓冲区足够大时，滑动窗口变大，允许更多数据在确认前发送
- 滑动窗口小：当网络拥塞或接收方缓冲区接近溢出时，滑动窗口变小，限制发送方在等待接收方确认前可发送的数据量

4. 拥塞控制：发送方需维护一个拥塞窗口，使用如慢启动、拥塞避免、快重传和快恢复的拥塞控制机制，动态调整数据的发送速率以减少网络拥堵

- 慢启动：连接开始时，拥塞窗口从 1 或 1 个较小的值开始，每接收 1 个 ACK，cwnd 增加 1 个 MSS 大小，呈指数增长
- 拥塞避免：当 cwnd 达到阈值时，每个 RTT 增加 1 个 MSS 大小，呈线性增长
- 快重传：当发送方接收 3 个重复的 ACK 时，它立即重传丢包而不是等待超时，不像超时重传那样减少拥塞窗口，继续通过拥塞避免算法增加 cwnd
- 快恢复：在接收到重复 ACK 时，将 cwnd 减半，并将 ssthresh 设置为这个新的 cwnd 值，进入快速恢复阶段，每收到 1 个重复的 ACK，cwnd 增加 1 个 MSS 大小，直到接收到新的数据确认，一旦接收到新的 ACK，将 cwnd 设置为 ssthresh 的值，返回拥塞避免阶段

5. 有序传输：保证数据按照发送顺序到达接收方，若数据包到达顺序错乱，则重排包序

6. 保活机制 Keepalive：若在指定的时间内，连接上无任何数据传输，TCP 自动定期发送保活探测包即 Keepalive 探针以检测对方是否仍可响应，确认连接的有效性，若在指定时间内未接收响应，则认为连接已失效，自动关闭连接
