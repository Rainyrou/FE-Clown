XSS：攻击者通过页面对用户输入过滤不足的漏洞，将恶意 HTML 或 JavaScript 注入至页面，当其他用户访问与该页面同源的目标页面时，这些恶意 HTML 或 JavaScript 继承目标页面的权限，在被攻击页面的同源上下文中执行，获取用户的敏感数据

- 反射型 XSS：恶意脚本通过 URL 参数或表单提交等方式临时注入至请求中，服务端接收到请求后，将恶意脚本反射至页面，浏览器执行该恶意脚本
- 存储型 XSS：恶意脚本存储于服务端，当用户访问包含该脚本的页面时，服务端将恶意脚本返回给浏览器，浏览器执行该恶意脚本
- DOM 型 XSS：恶意脚本通过修改页面的 DOM 节点执行

防御：

- 通过转义函数和模板引擎过滤和转义输入以确保其不被解释为代码
- 避免使用 `eval`、`innerHTML` 和 `document.write` 等将字符串作为代码执行或插入 HTML 的 API
- 设置 Cookie 时，`HttpOnly` 防止 JavaScript 通过 `document.cookie` 获取，`Secure` 确保 Cookie 只通过 HTTPS 传输
- 通过 HTTP 头部字段或 HTML meta 标签的 Content Security Policy 限制页面可执行的脚本来源

SQL Injection：攻击者通过应用对用户输入过滤不足的漏洞，将恶意 SQL 代码注入至应用 SQL 查询语句中，篡改原先 SQL 的执行逻辑，执行窃取和破坏数据等

- 联合查询注入：通过 `UNION` 操作符在原有查询后拼接新查询语句，获取其他表数据
- 报错注入：通过构造触发报错的 SQL 片段，使数据库返回包含敏感数据的错误提示
- 布尔盲注：通过注入 `OR` 条件并观察应用响应差异判断条件真假，逐字符猜解数据
- 时间盲注：通过注入时间延迟函数并观察应用响应时间判断条件真假，猜解数据

防御：

- 通过转义函数和模板引擎过滤和转义输入以确保其不触发 SQL 注入
- 参数化查询，将 SQL 语句分为模板和参数，编译 SQL 模板以确定执行逻辑，再传入用户输入，数据库仅将参数视为数据，不解析为 SQL 指令
- 最小权限原则，仅授予必要权限，禁止数据库账号远程登录
- 生产环境关闭错误回显，隐藏敏感数据

CSRF：通过浏览器同源请求自动携带会话信息的机制，在用户已登录目标页面的情况下，攻击者诱使用户触发其构造的恶意请求，让目标页面误以为是用户的自发操作，从而执行未授权的恶意行为

防御：

- 服务端为各个用户会话生成唯一随机 Token 并将其嵌入到页面表单或请求，客户端请求时携带该 token，服务端验证请求中的 token 与会话中存储的 token 是否一致
- 对敏感操作要求用户通过密码、验证码或生物识别等方式进行二次验证
- 设置 Cookie 时，`SameSite` 属性设置为 `Strict` 或 `Lax` 以限制第三方请求自动携带 Cookie
- 服务端通过检查 HTTP 请求头部的 `Referer` 或 `Origin` 字段以验证请求来源是否合法

MITM： 攻击者通过协议弱认证的漏洞非法接入通信链路，对客户端伪装为服务端，对服务端伪装为客户端，作为中介/代理将客户端请求转发给服务端，将服务端响应转发给客户端，双向欺骗通信双方实现窃取、篡改和阻断数据流

- DNS 劫持 MITM：攻击者通过协议漏洞向目标 DNS 服务端发送伪造的 DNS 响应，污染其缓存，用户请求目标 DNS 服务端时，DNS 缓存返回攻击者 IP，用户发送请求给攻击者，攻击者将其转发给服务端
- HTTP MITM：攻击者向目标主机发送伪造的 ARP 响应，篡改其网关 MAC，目标主机发送 HTTP 请求给攻击者，攻击者接收请求并篡改请求参数，将其转发给网关，网关返回响应后将其转发给目标主机
- HTTPS MITM：攻击者拦截 HTTPS 请求，将其重定向并降级为 HTTP，后续按 HTTP MITM 方式处理；攻击者伪造服务端 SSL 证书并在 SSL/TLS 握手阶段返回给用户，用户无视证书不可信提示继续访问，攻击者通过私钥解密客户端流量，再通过服务端公钥加密转发

防御：

- 通过 DNS 安全扩展校验 DNS 响应签名
- 网关配置静态 IP-MAC 静态映射表并禁用动态 ARP 缓存更新
- VPN
- 升级 TLS 版本并关闭从 HTTPS 到 HTTP 的降级协商功能
- 服务端证书链校验，CA 签名、证书有效性和域名
- 双向认证，SSL/TLS 握手过程中客户端和服务端验证彼此证书
- 证书锁定，通过客户端内置的服务端证书公钥指纹校验服务端证书是否匹配

DDoS：攻击者通过控制僵尸节点向服务端发送大量恶意请求，耗尽其网络带宽、连接状态表或服务端资源，导致其无法响应用户请求

- 放大攻击：攻击者伪造源 IP，向开放的 DNS 服务端发送小的 DNS 查询请求，DNS 服务端未验证源 IP 合法性并返回包含大量解析记录的响应给源 IP
- UDP Flood：UDP 无需在数据传输前建立连接，攻击者通过控制僵尸节点发送大量 UDP 数据包，占满服务端网络带宽
- SYN Flood：三次握手（SYN -> SYN-ACK -> ACK），服务端接收到伪造的 SYN 报文后为各个请求分配内存以保持连接状态并进入 SYN_RECV 半连接状态，但攻击者不发送 ACK 报文，因此 TCP 连接队列被无效连接占满，无法为新的请求分配内存
- HTTP Flood：攻击者控制僵尸节点向服务端发送大量 GET/POST 请求，强制其执行高 IO/CPU 操作
- 慢速攻击：攻击者通过与服务端建立大量 HTTP 连接，通过缓慢发送等形式保持连接不超时，服务端为这些未完成请求的连接分配内存，因此服务端连接池被无效连接占满，无法为新的请求分配内存

防御：

- 源 IP 验证与访问控制：公共服务端 IP 启用源 IP 反向验证，限制单源 IP 的请求频率和连接数量，通过流量特征检测放大攻击，禁止返回包含大量解析记录的响应
- UDP 流量控制：通过路由器或防火墙配置基于源 IP、目的端口和包速率的 UDP 流量限速策略，关闭无用的 UDP 服务与端口
- SYN Cookie：服务器不提前分配连接资源，而通过 Cookie 验证客户端合法性
- WAF：通过请求特征 + 行为分析过滤恶意请求，限制单源 IP 的请求频率和连接数量，对可疑 IP 强制校验验证码
- 限流降级：基于令牌桶/漏桶算法，限制单源 IP 的请求频率和连接数量及单接口的 QPS 上限，高并发时关闭非核心接口或返回缓存数据，优先保障核心功能
- 请求超时与完整性校验：服务端配置 HTTP 请求超时期限且校验请求完整性，升级 HTTP2/3，通过多路复用机制减少连接数占用
