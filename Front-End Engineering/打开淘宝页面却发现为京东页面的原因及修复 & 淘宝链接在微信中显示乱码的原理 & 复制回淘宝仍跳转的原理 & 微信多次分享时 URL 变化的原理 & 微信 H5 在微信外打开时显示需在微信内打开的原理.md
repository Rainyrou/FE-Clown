打开淘宝页面却发现为京东页面的原因：

- DNS 劫持 MITM：攻击者通过协议漏洞向目标 DNS 服务端发送伪造的 DNS 响应，污染其缓存，用户请求目标 DNS 服务端时，DNS 缓存返回攻击者 IP，用户发送请求给攻击者，攻击者将其转发给服务端
- HTTPS MITM：攻击者伪造服务端 SSL 证书并在 SSL/TLS 握手阶段返回给用户，用户无视证书不可信提示继续访问，攻击者通过私钥解密客户端流量，再通过服务端公钥加密转发
- Host 文件/代理/CDN 配置错误
- 重定向劫持
- 淘宝客户端沙箱逆向破解，注入京东客户端代码

修复：

- 通过 DNS 安全扩展校验 DNS 响应签名
- VPN
- 升级 TLS 版本并关闭从 HTTPS 到 HTTP 的降级协商功能
- 服务端证书链校验，CA 签名、证书有效性和域名
- 双向认证，SSL/TLS 握手过程中客户端和服务端验证彼此证书
- 证书锁定，通过客户端内置的服务端证书公钥指纹校验服务端证书是否匹配
* 检查 Host 文件、代理和 CDN 配置
* 检查前端网络拦截器
* 重构淘宝客户端沙箱以防止注入攻击

淘宝链接在微信中显示乱码的原理：淘宝通过淘口令技术实现跨平台链接传输，混合加密原始 URL 和元数据，淘宝微信不同的编解码方式导致淘宝加密的字符串在微信中显示乱码

复制回淘宝仍跳转的原理：淘宝通过前缀标识和模式匹配判断淘宝链接格式并将加密字符串解密，通过 API 跳转至相应页面

微信多次分享时 URL 变化的原理：服务端为追踪用户点击和签名验证向原始 URL 注入一次性动态查询参数

微信 H5 在微信外打开时显示需在微信内打开的原理：前端代码通过 User Agent + 浏览器内核属性 + 浏览器指纹识别技术判断是否为微信内置浏览器，通过自身 DNS 解析监控/过滤/拦截相关请求，修改前端页面内容并设置蒙层和提示文案，通过生态闭环以防止用户流失
