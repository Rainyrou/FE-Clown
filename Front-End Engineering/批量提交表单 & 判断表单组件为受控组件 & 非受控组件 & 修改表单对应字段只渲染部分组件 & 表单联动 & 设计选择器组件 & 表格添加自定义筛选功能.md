批量提交表单：

- 合并多表单数据，一次请求提交
- 多请求并发提交

判断表单组件为受控组件 & 非受控组件：

- 判断标准：表单元素的值的控制权归属 React 组件状态控制 → 受控组件 + DOM 元素原生控制 → 非受控组件
- 底层原理：受控组件为 React 主动管理状态 → 驱动视图更新，非受控组件为 DOM 自主管理状态 → React 被动读取
- 表象特征：受控组件显式绑定  `value`  且通过  `setState`  触发更新，非受控组件通过  `defaultValue`  初始化且通过  `ref`  读取
- 设计取舍：受控组件适合复杂表单如表单联动和实时校验，非受控组件适合简单表单

修改表单对应字段只渲染部分组件：

- 渲染隔离：`React.memo/useMemo/useCallback` 依赖数组只包含单个字段
- 状态隔离：将 `useState` 从 `<Form>` 根组件移动到各个独立的 `<Field>` 组件内部，各个 `<Field>` 组件管理自身的 `value` 状态，修改字段只更新对应字段的状态引用，不影响其他字段的状态
- 表单库：表单变为非受控组件，各个字段通过 `ref` 访问 DOM 元素值，通过  `register`  注册后形成独立的字段状态单元，修改时通知订阅该字段的组件重新渲染

表单联动：表单支持嵌套、实时校验、自动补全、多语言联动和多草稿编辑

1. 表单嵌套：树形数据结构的可视化与交互，通过"带层级标识的递归对象数组"描述嵌套关系，各个节点包含自身字段类型、默认值和子节点列表，适配商品 → SKU → 属性项的层级，将字段类型与对应 UI 组件相关联，接收当前节点数据，若节点类型为数组或对象，渲染对应组件并递归渲染子节点列表，否则根据字段类型从组件映射表中匹配 UI 组件，传入相应 props，提供新增和删除按钮以动态增删节点
2. 实时校验：各个字段通过  `rules`  配置校验规则，支持同步/异步函数，通过  `validateState`  对象存储字段校验结果，与表单数据分离，结构与  `formData`  对齐，实时触发与状态冒泡，内联逻辑 -> Schema -> 业务规则引擎

- 字段值联动：源字段值变化 → 目标字段值同步/异步计算/更新
- 显隐/启禁联动：源字段值满足特定条件 → 目标字段显示/隐藏或启用/禁用变化
- 校验规则联动：源字段值变化 → 目标字段的校验规则动态切换
- 跨表单联动：表单 A 的字段变化 → 表单 B 的字段同步/异步计算/更新
- Schema：整个表单包括其字段、数据类型、页面布局、校验规则和联动逻辑抽象为声明式的、与编程语言无关的 JSON 数据结构，表单渲染引擎在运行时读取 Schema 并动态生成对应 UI、校验器和事件监听器
- 业务规则引擎：由一系列规则构成，各个规则均包含一个  `CONDITION` 和一个  `ACTION`，当表单状态变化时，业务规则引擎根据其状态对象，评估所有规则的 `CONDITION` 部分，对所有条件为真的规则，业务规则引擎收集其对应 `ACTION` 并返回 `ACTION` 集合，表单 UI 层接收到 `ACTION` 集合后执行相应动作即可

3. 自动补全：基于父字段值筛选补全选项，底层依赖关联字段映射，用户选中补全选项后，回填当前字段值并触发联动字段补全，本地静态数据 -> 一级缓存，存储于内存；本次会话查询过的数据 -> 二级缓存，通过 `Map`  存储，键为关键值，值为补全结果，再次查询时直接复用；本地缓存无数据 -> 调用后端接口查询，返回结果后同步更新于前端缓存

4. 多语言联动：通过 JSON 文件存储多语言文本，键为全局唯一标识，值为多语言文本
5. 多草稿编辑：各个草稿状态通过全局 Store 分别独立存储于草稿字典，为各个草稿分配唯一 ID 并将其作为 URL 的一部分，组件挂载时从 URL 读取 `draftId`

```js
useSelector(state => state.drafts[draftId].products["p1"]) // 读取
dispatch(updateField({ draftId: draftId, ...payload })) // 写入
```

选择器组件：

| classNames               | 配置选择器内置模块的 className                                                               | [Record<SemanticDOM, string>](https://ant.design/components/select-cn#semantic-dom)        | -                                                                           |
| ------------------------ | ---------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------- |
| styles                   | 内联样式                                                                               | [Record<SemanticDOM, CSSProperties>](https://ant.design/components/select-cn#semantic-dom) | -                                                                           |
| defaultValue             | 指定默认选中的条目                                                                          | string \| string[] \|  <br>number \| number[] \|  <br>LabeledValue \| LabeledValue[]       | -                                                                           |
| fieldNames               | 自定义节点 label、value、options、groupLabel 字段                                            | object                                                                                     | { label: `label`, value: `value`, options: `options`, groupLabel: `label` } |
| filterOption             | 根据输入项筛选，当其为函数时，接收 `inputValue` 和 `option` 参数，当 `option` 符合筛选条件时，返回 true，反之返回 false | boolean \| function(inputValue, option)                                                    | true                                                                        |
| filterSort               | 筛选结果的排序函数                                                                          | (optionA: Option, optionB: Option, info: { searchValue: string }) => number                | -                                                                           |
| searchValue              | 搜索文本                                                                               | string                                                                                     | -                                                                           |
| placeholder              | 选择框默认文本                                                                            | string                                                                                     | -                                                                           |
| loading                  | 加载中状态                                                                              | boolean                                                                                    | false                                                                       |
| defaultOpen              | 是否默认展开                                                                             | boolean                                                                                    | -                                                                           |
| defaultActiveFirstOption | 是否默认高亮首个选项                                                                         | boolean                                                                                    | true                                                                        |
| maxCount/maxTagCount     | 选中项的最多数量                                                                           | number                                                                                     | -                                                                           |
| autoFocus                | 自动聚焦                                                                               | boolean                                                                                    | false                                                                       |
| allowClear               | 自定义清除按钮                                                                            | boolean \| { clearIcon?: ReactNode }                                                       | false                                                                       |
| disabled                 | 是否禁用                                                                               | boolean                                                                                    | false                                                                       |
| onSearch                 | 搜索框值变化时触发的回调                                                                       | function(value: string)                                                                    | -                                                                           |
| onChange                 | 选中项或输入值变化时触发的回调                                                                    | function(value, option:Option \| Array<Option>)                                            | -                                                                           |
| onSelect                 | 选中时触发的回调                                                                           | function(value: string \| number \| LabeledValue, option: Option)                          | -                                                                           |
| onDeSelect               | 取消选中时触发的回调                                                                         | function(value: string \| number \| LabeledValue)                                          | -                                                                           |
| onOpenChange             | 展开下拉菜单的回调                                                                          | (open: boolean) => void                                                                    | -                                                                           |
| onPopupScroll            | 下拉列表滚动时的回调                                                                         | (event: UIEvent) => void                                                                   | -                                                                           |
| onInputKeyDown           | 按键按下时回调                                                                            | (event: KeyboardEvent) => void                                                             | -                                                                           |
| onFocus                  | 获得焦点时触发的回调                                                                         | (event: FocusEvent) => void                                                                | -                                                                           |
| onBlur                   | 失去焦点时触发的回调                                                                         | function                                                                                   | -                                                                           |
| onClear                  | 清空内容时触发的回调                                                                         | function                                                                                   | -                                                                           |

通过 `div/button/ul/li` 等模拟原生选择器的触发区、下拉面板和选项列表，通过 React 状态控制选择器的加载/搜索状态、下拉面板的展开/收起和选项的单选/多选/高亮，结合事件监听和键盘导航还原交互逻辑


表格添加自定义筛选功能：

* 抽象接口：设置、获取和重置筛选条件 + 筛选条件修改回调 + 筛选条件合法性校验
* 筛选器：基础型筛选器（输入框/下拉框/单选框），单一条件筛选；复合型筛选器（区间选择/多值选择/逻辑组合），多维条件筛选；自定义筛选器，自定义条件筛选
* 管理生命周期：根据行列配置渲染表格渲染，实例化对应自定义筛选器，通过设置回显之前保存的筛选条件，用户操作，筛选器内部执行交互逻辑，通过回调将结构化条件传递给适配层，适配层将筛选条件转换为表格可识别格式，根据配置触发客户端或服务端筛选，表格根据过滤后的数据重新渲染同并步筛选器状态，用户重置筛选后表格通过回调清空筛选条件并重新渲染