白屏检测即在页面加载完后判断其是否有关键渲染内容

原因：

1. DOM 结构异常导致未生成有效 Render/Layout 树
2. JavaScript 执行错误导致渲染逻辑中断
3. 关键 CSS、JavaScript 或静态资源加载失败

方案：

H5 截图检测：通过类似 `html2canvas` 库在 JavaScript 中重新实现浏览器渲染，遍历 DOM 和 CSSOM 树，将 HTML 标签翻译为 Canvas 的 `draw` API，通过 `toDataURL` 将页面转换为 Base64 图片，对图片进行像素级别扫描对比，检测页面是否为纯色如全白或全黑，考虑 `html2canvas` 库体积、CPU 绘制、不兼容 Iframe、Web Component 和部分 CSS 属性和截图时机

采样对比检测：

* 采样点元素为有效内容同时满足1、2、3点及456点的某一维度（1 && 2 && 3 && (4 || 5 || 6)）：

1. 不为根容器元素 `html/body/#app/#root`
2. 不为骨架屏元素，通过骨架屏特征库判断，如 `background`  为渐变色、`animation`  或 CSS 类名含  `skeleton` 字眼和 `data-skeleton="true"` 等
3. 不为隐藏元素如 `visibility: hidden/opacity: 0/position: absolute`  且不位于视口
4. 存在文本节点，元素内部有非空白文本，通过  `element.textContent.trim() !== ''`  判断
5. 存在非纯色背景/图片，通过  `getComputedStyle`  获取计算后样式，判断  `background-color`、`background-image` 和 `img.naturalWidth`
6. 存在交互元素如按钮、输入框或为可点击样式且宽高大于 20px

* 业界通用采样点布局为 F 型浏览模式（视觉聚焦浏览器页面的上中部 + 左中部），基于"用户视觉焦点 + DOM 渲染"设计，将视口划分为 9 个相等区域，选取各个区域的中心点（如上中 -> `x=innerWidth/2, y=innerHeight/6` 中中 -> `x=innerWidth/2, y=innerHeight/2`），共 9 个采样点，额外补充首屏核心内容区采样点如顶部导航下沿 + Banner 区域中心 + 主体内容区上沿，若这些点无有效内容，基本可判定白屏，通过 `document.elementsFromPoint` 获取各采样点处的最上层可见 DOM 元素，判断其是否有有效内容，若无则判断页面白屏
* 业界通过多轮采样检测，在 `DOMContentLoaded` 事件触发前启动 JavaScript 错误检测，提前捕获可能导致白屏 JavaScript 错误（`window.error` -> 未被捕获的全局运行时错误 + `unhandledrejection` -> 未被处理的 rejected Promise + `resourceerror` -> 静态资源加载错误），在 `DOMContentLoaded` 事件触发后经过 1.5s（经验主义的静默期，为 JavaScript SDK 初始化和首屏数据请求提供一定的缓冲时间） 后首次采样（T1），若T1白屏则经过 1s 后再次采样（T2）以覆盖"1.5s 内未完成渲染"的情况，若 T2 仍白屏，经过 2s 后第三次采样以覆盖绝大多数弱网环境下的页面基础渲染耗时，终止条件为任一采样时刻命中有效内容 → 停止采样 & 三次采样均白屏 → 判断为疑似白屏，`load` 事件触发后若仍未采样到有效内容则补充一次兜底采样，若兜底采样仍白屏，则判定为持续白屏，若兜底采样命中有效内容，则修正先前的疑似白屏状态，不上报
* 通过 `MutationObserver` 监听子树、子节点增删和元素属性变化，若 8 秒内无任何 DOM 变化则进入二次验证，否则在 `requestIdleCallback` 中重新采样，通过 `performance.getEntriesByType('longtask')` 实时收集长任务（耗时 > 50ms），若 8 秒内存在 ≥3 个长任务（耗时 > 500ms）且无 DOM 变化则判断为"长任务导致的卡死白屏"
* 生成唯一 `uuid` 绑定于同一白屏事件，用于关联预检测阶段的错误日志 + 多轮采样的结果 + 卡死检测的长任务状态，上报策略为分级上报，疑似白屏仅在客户端缓存日志，不上报，确认白屏则立即上报全量上下文，卡死白屏则额外上报"长任务调用栈"和"资源加载明细"等深层数据

| 字段类别          | 具体内容                         | 底层来源                                       |
| ------------- | ---------------------------- | ------------------------------------------ |
| 基础环境          | 设备机型、操作系统、浏览器内核、网络           | `navigator.userAgent/navigator.connection` |
| 时间线           | T0、T1-T3                     | `performance.now`                          |
| 白屏状态          | 判定类型（疑似/确认）、采样结果（3 次采样的元素列表） | 自定义采样逻辑                                    |
| 卡死类型          | 长任务卡死/资源加载卡死/JS 执行卡死         | 多维度判断逻辑                                    |
| 性能指标          | FP、FCP、LCP                   | `PerformanceObserver` 监听                   |
| JavaScript 错误 | 错误信息                         | `window.error/unhandledrejection`          |
| 静态资源加载错误      | 静态资源 URL、错误码                 | `resourceerror` 事件                         |
| 长任务信息         | 长任务耗时、调用栈                    | `Performance API` 获取长任务列表                  |
| DOM 结构快照      | 首屏 DOM 的简化结构                 | 递归遍历 `document.body` 生成                    |
| 网络请求状态        | 首屏接口、状态码                     | `AJAX/AxiosI/Fetch` 监听                     |


