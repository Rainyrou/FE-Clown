设计图片加载接口：

1. 接口设计

- 接口命名语义化，参数分为必选核心参数（如图片 URL/挂载容器）和可选拓展参数（如加载策略/缓存规则/兜底配置），保证核心功能的最小接入成本，同时适配不同业务场景的个性化需求，避免参数冗余
- 接口核心逻辑与扩展逻辑解耦，支持业务方注册自定义插件（如自定义图片压缩规则/错误兜底逻辑）

2. 性能优化：

- 动态适配：判断浏览器对不同图片格式的兼容性，优先使用 Webp 格式；通过 `navigator.userAgent/window.devicePixelRatio` 分别判断机型设备和设备像素比，加载合适的分辨率图片
- 加载策略：预加载（配置触发条件，提前缓存需要展示的图片）+ 懒加载（`Intersection Observer`）+ 优先级加载（设置 `fetchpriority="high"`）
- 多级缓存：内存缓存（基于 LRU 算法） + 本地缓存（`localStorage/IndexedDB`）+ CDN 缓存
- 网路请求：支持取消请求

3. 异常处理：

- 错误分类：区别错误类型（格式错误/网络错误/跨域错误/超时错误），返回状态码 + 错误信息
- 重试机制：对网络请求失败通过指数退避重试（重试间隔 1s → 2s → 4s）并限制最大重试次数
- 跨域处理：配置 CORS 请求头部或通过 SDK 内置代理解决跨域问题
* 降级兜底：加载失败时优先级为通过备用 CDN 加载 → 占位图渲染兜底 → 业务方自定义兜底逻辑

4. 埋点设计：内置核心指标埋点（加载耗时/缓存命中率），支持业务方接入自定义埋点

5. 安全合规：校验图片 URL，过滤转义清洗特殊字符，限制协议/域名白名单

多系统 API 数据结构不一致问题：

- 梳理全链路业务，提取字段核心语义，定义标准化字段
* 根据系统标识配置源字段 - 标准字段的映射表，封装格式转换函数
* 适配器接收系统标识和原始数据，遍历原始数据字段，根据系统标识和映射表查找对应标准字段，调用格式转换函数将源数据转换为标准数据，校验字段缺失和类型异常并以默认值为兜底
* 跨系统复用映射表、格式转换函数和适配器，通过「系统标识 + 原始数据哈希」为键缓存标准数据，长缓存静态数据，按需缓存动态数据