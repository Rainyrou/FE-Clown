[224. 基本计算器](https://leetcode.cn/problems/basic-calculator/)

[227. 基本计算器 II](https://leetcode.cn/problems/basic-calculator-ii/)

```javascript
var calculate = function(s) {
  const ops = [1];
  let ans = 0, sign = 1, i = 0;
  while(i < s.length) {
    if(s[i] === ' ') {
      ++i;
    } else if(s[i] === '+') {
      sign = ops[ops.length - 1];
      ++i;
    } else if(s[i] === '-') {
      sign = -ops[ops.length - 1];
      ++i;
    } else if(s[i] === '(') {
      ops.push(sign);
      ++i;
    } else if(s[i] === ')') {
      ops.pop();
      ++i;
    } else {
      let num = 0;
      while(i < s.length && !isNaN(Number(s[i])) && s[i] !== ' ') {
        num = num * 10 + Number(s[i]);
        ++i;
      }
      ans += sign * num;
    }
  }
  return ans;
};
```

- 栈存储符号即+1 或-1，`sign` 记录当前数字正负，始终等于栈顶元素，即当前层的符号规则
- 左括号  → 压入括号前的符号，其为括号内所有运算的基础乘数
- 右括号  → 弹出括号前的符号，移除基础乘数，恢复外层的符号规则
