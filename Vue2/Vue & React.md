> [!todo] To do
> 花了一天写的，全文背诵

Vue.js 和 React 都是构建用户界面的 JavaScript 库，尽管它们都旨在帮助开发者构建前端应用程序，但它们在设计哲学、响应性原理、模板化、生态系统和工具链方面存在着一些关键差异

1. **设计哲学**：

Vue 和 React 的核心理念差异定义了它们的发展轨迹。React 从一开始就致力于定义 UI 开发的新范式，它要求开发者按照一定规则来编码（即我制定规则，你们都得听我的），它有 Facebook 的背书，确保了它的流行和生态发展。而 Vue 则聚焦于降低前端开发的门槛，它更多地尊重和适应开发者的习惯（怎么爽怎么来），这种灵活性使得 Vue 能够更快地适应社区的需求变化

- Vue 采用基于 HTML 的模板语法，提供数据驱动的视图层框架，允许开发者声明式地将 DOM 绑定到底层 Vue 实例的数据。Vue 更倾向于"万物皆组件"的思想，鼓励开发者使用组件来构建应用程序
- React 采用 JSX，使得在 JavaScript 代码中可以写类似 HTML 的代码。React 更倾向于"学习一次，随处编写"的思想，它侧重于 UI 组件化，采用单向数据流，通过 State 来控制 UI 的更新。它不提供完整的框架解决方案，而是侧重于构建高效的 UI 层，并鼓励使用不可变数据来推动 UI 的更新

2. **响应式**：

- Vue2  响应式的特点是依赖收集，数据可变，自动派发更新，初始化时通过 `Object.defineProperty`  递归劫持  `data` 所有属性，为其添加 `getter` 和 `setter`。每个组件实例关联一个 `watcher` 实例，在组件渲染时进行依赖收集，并在依赖项的 `setter` 被调用时通知 `watcher` 重新渲染
- Vue3 使用原生 `Proxy`  重构响应式，`Proxy`  修复 Vue2 响应式存在的缺陷，它可以拦截对象的任意操作，支持更多数据结构，且不再一开始就递归劫持对象属性，而是代理第一层对象本身，运行时才递归，按需代理，用 `effect`  副作用来代替 Vue2  里的 `watcher`，用 `trackMap`  代替 Vue2  中的 `Dep` 统一管理依赖，无需再维护大量依赖关系，性能显著提升
- React  的响应式不是自动的，它基于状态，单向数据流，数据不可变，需要手动 `setState`  来显式触发更新，且当数据改变时会以根组件为目录，默认重新渲染整个组件树，需要额外使用 `pureComponent` 和 `shouldComponentUpdate` 等防止不必要的渲染，更新粒度更大一些。React16 之后通过引入 Fiber 架构，性能显著提升

3. **Diff 算法**：

- Vue 2 的 diff 算法采用双指针比较新旧虚拟节点的子节点列表。同层级 vnode 进行比较，如果新的 vnode 存在而旧的不存在，则创建新节点；反之，则删除旧节点。在处理子节点时，使用了四个指针（旧前、旧后、新前、新后）进行头尾和尾头的比对，尽可能地复用现有节点，避免不必要的 DOM 操作。移动节点时通过 `splice`  进行数组操作
- Vue 3 对 diff 算法进行了优化，增加了更多的静态标记。在编译阶段，Vue 3 能够检测并标记出静态的根节点，这些节点在 diff 过程中可以被直接跳过。对于动态子节点的比较，Vue 3 使用了 `Map` 数据结构来跟踪节点的索引。Vue 3 还引入了最长递增子序列算法来优化比对过程，它通过比较 `source` 数组记录的位置信息来实现
* React 递归进行同层 vnode 比较，识别差异后将其添加到 `Diff` 队列中，得到一个 patch 树，统一批量操作更新 DOM。如果组件类型或 key 不同，React 直接卸载旧组件并安装新组件。对于列表元素的处理，React 通过比较新旧集合中节点的位置和 `lastIndex` 来判断节点是否需要移动。当新的 vnode 在旧的 vnode 集合中找不到对应时，它会被创建。当旧的 vnode 在新的 vnode 集合中找不到对应时，它会被删除

4. **组件化和数据流**：

数据管理方式也是 Vue 和 React 两者之间的差异之一。Vue 的响应式系统和 React 的状态管理模式是两种截然不同的设计哲学，这不仅影响了它们的内部架构设计，也影响了它们各自的社区和生态系统的发展。Vue 的响应式数据绑定提供了一种更加细粒度的更新机制，而 React 的函数式状态管理则倾向于更可预测的数据流

- Vue 的组件化是其核心特性之一，通过 `.vue` 单文件组件提供了清晰的组织方式。Vue 组件通过 `props` 进行父子组件间的通信，通过自定义事件来处理子到父的通信，提倡单向数据流
- React 同样使用 `props` 进行组件间的通信，并提倡单向数据流。React 从 16.3 开始提供新的 Context API 来更方便地处理跨组件的数据传递

5. **模板化**：

- Vue 采用基于 HTML 的模板语法，允许使用指令和模板插值等简化 DOM 操作。Vue3 通过 Composition API 进一步增加了对逻辑关注点分离的支持
- React 使用 JSX，一个看起来像 HTML 的 JavaScript 扩展。这让 React 开发更接近传统的 JavaScript 编程

从加载速度和运行时性能来说，我觉得这两个框架综合各种场景没有本质的差别。硬要说的话，Vue  在更新时在性能优化方面需要的心智负担可能会少一些，特别是  Vue3，而  React  如果不注意，容易导致一些组件无用的  Diff，但实际项目中真正能遇到这种性能瓶颈的也是极少数，所以...

(如果公司主 Vue)：总的来说，我觉得 Vue  在性能上略胜一筹，特别是 Vue3，有更好的可扩展性、更快的渲染速度和更小的打包体积。从 mixins  到 HOC  到  render props 再到 hooks，React 已基本废弃过去很多基于组件的逻辑抽象模式，抹掉了 JSX 对比 Template 的一大优势，而现在 Vue3 也都能做到，因此我会偏向 Vue3

(如果公司主 React)：总的来说，我觉得在一些小型系统或 H5  端用 Vue 可能会好一些，因为不管是上手还是开发都相对容易，而且它有更小的打包体积。但像一些中后台系统，或多人开发的大型项目，用 React，因为它的函数式编程有更灵活的结构和可扩展性，生态和工具链，解决方案也比较多，后期更方便维护和迭代，还适用原生 APP，因此我会偏向 React
